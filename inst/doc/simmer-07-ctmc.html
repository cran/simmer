<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Iñaki Ucar" />

<meta name="date" content="2024-09-27" />

<title>Continuous-Time Markov Chains</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Continuous-Time Markov Chains</h1>
<h4 class="author">Iñaki Ucar</h4>
<h4 class="date">2024-09-27</h4>


<div id="TOC">
<ul>
<li><a href="#example-1" id="toc-example-1">Example 1</a></li>
<li><a href="#example-2" id="toc-example-2">Example 2</a></li>
</ul>
</div>

<script type="text/x-mathjax-config">
  MathJax.Ajax.config.path["Contrib"] = "https://cdn.mathjax.org/mathjax/contrib";
  MathJax.Hub.Config({
    TeX: {extensions: ["[Contrib]/xyjax/xypic.js","AMSmath.js","AMSsymbols.js"]},
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(simmer)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(simmer.plot)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>A gas station has a single pump and no space for vehicles to wait (if
a vehicle arrives and the pump is not available, it leaves). Vehicles
arrive to the gas station following a Poisson process with a rate of
<span class="math inline">\(\lambda=3/20\)</span> vehicles per minute,
of which 75% are cars and 25% are motorcycles. The refuelling time can
be modelled with an exponential random variable with mean 8 minutes for
cars and 3 minutes for motorcycles, that is, the services rates are
<span class="math inline">\(\mu_\mathrm{c}=1/8\)</span> cars and <span class="math inline">\(\mu_\mathrm{m}=1/3\)</span> motorcycles per minute
respectively.</p>
<p>This problem is described by the following continuous-time Markov
chain:</p>
<p><span class="math display">\[\xymatrix{
*=&lt;15mm,8mm&gt;[o][F]{car} \ar@/^/[r]^{\mu_\mathrm{c}} &amp;
*=&lt;15mm,8mm&gt;[o][F]{empty} \ar@/^/[l]^{p\lambda}
\ar@/^/[r]^{(1-p)\lambda}  &amp;
*=&lt;15mm,8mm&gt;[o][F]{m/cycle} \ar@/^/[l]^{\mu_\mathrm{m}}
}\qquad\qquad
Q = \begin{pmatrix}
-\mu_\mathrm{c} &amp; \mu_\mathrm{c} &amp; 0 \\
p\lambda &amp; -\lambda &amp; (1-p) \lambda \\
0 &amp; \mu_\mathrm{m} &amp; -\mu_\mathrm{m}
\end{pmatrix}\]</span></p>
<p>with <span class="math inline">\(p=0.75\)</span>. The chain is
irreducible and recurrent. To theoretically find the steady state
distribution, we have to solve the balance equations</p>
<p><span class="math display">\[pQ = 0\]</span></p>
<p>with the constraint</p>
<p><span class="math display">\[\sum_i p_i = 1\]</span></p>
<p>There are <span class="math inline">\(\operatorname{dim}(Q)-1\)</span> independent
columns, so the latter constraint is equivalent to substitute any column
by ones and match it to one at the other side of the equation, that
is:</p>
<p><span class="math display">\[p\cdot\begin{pmatrix}
1 &amp; 1/8 &amp; 0 \\
1 &amp; -3/20 &amp; 0.25\cdot 3/20 \\
1 &amp; 1/3 &amp; -1/3
\end{pmatrix} = (1, 0, 0)\]</span></p>
<p>The solution <span class="math inline">\(p\)</span> represents the
probability of being at each state in the long-term. Therefore, we can
calculate the average number of vehicles in the system by summing these
probabilities multiplied by the number of vehicles at each state. In our
case,</p>
<p><span class="math display">\[N = 1\cdot p_1 + 0\cdot p_2 + 1\cdot
p_3\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Arrival rate</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">20</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Service rate (cars, motorcycles)</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Probability of car</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Theoretical resolution</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,   mu[<span class="dv">1</span>],            <span class="dv">0</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>              <span class="dv">1</span>, <span class="sc">-</span>lambda, (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>              <span class="dv">1</span>,   mu[<span class="dv">2</span>],       <span class="sc">-</span>mu[<span class="dv">2</span>]), <span class="at">byrow=</span>T, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(A), B)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>N_average_theor <span class="ot">&lt;-</span> <span class="fu">sum</span>(P <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) ; N_average_theor</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.5031056</span></span></code></pre></div>
<p>Now, we are going to simulate the system with <code>simmer</code> and
verify that it converges to the theoretical solution. There are various
options for selecting the model. As a first approach, due to the
properties of Poisson processes, we can break down the problem into two
trajectories (one for each type of vehicle), which differ in their
service time only, and therefore two generators with rates <span class="math inline">\(\lambda_\mathrm{c} = p\lambda\)</span> and <span class="math inline">\(\lambda_\mathrm{m} = (1-p)\lambda\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>option<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  car <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  mcycle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;car&quot;</span>, car, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, p<span class="sc">*</span>lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;mcycle&quot;</span>, mcycle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>}</span></code></pre></div>
<p>Other arrival processes may not have this property, so we would
define a single generator for all kind of vehicles and a single
trajectory as follows. In order to distinguish between cars and
motorcycles, we could define a branch after seizing the resource to
select the proper service time.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>option<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  vehicle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="fu">branch</span>(<span class="cf">function</span>() <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p)), <span class="fu">c</span>(T, T), </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;car&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;mcycle&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>]))) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;vehicle&quot;</span>, vehicle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>}</span></code></pre></div>
<p>But this option adds an unnecessary overhead since there is an
additional call to an R function to select the branch, and therefore
performance decreases. A much better option is to select the service
time directly inside the <code>timeout</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>option<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  vehicle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() {</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> p) <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])  <span class="co"># car</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>      <span class="cf">else</span> <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])               <span class="co"># mcycle</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;vehicle&quot;</span>, vehicle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>}</span></code></pre></div>
<p>This <code>option.3</code> is equivalent to <code>option.1</code> in
terms of performance. But, of course, the three of them lead us to the
same result. For instance,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>gas.station <span class="ot">&lt;-</span> <span class="fu">option.3</span>(<span class="dv">5000</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Evolution + theoretical value</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">get_mon_resources</span>(gas.station), <span class="st">&quot;usage&quot;</span>, <span class="st">&quot;pump&quot;</span>, <span class="at">items=</span><span class="st">&quot;system&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>N_average_theor)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>And these are some performance results:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">/</span>lambda</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>tm <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">option.1</span>(t), </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                     <span class="fu">option.2</span>(t), </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                     <span class="fu">option.3</span>(t))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">autoplot</span>(tm) <span class="sc">+</span> </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">breaks=</span><span class="cf">function</span>(limits) <span class="fu">pretty</span>(limits, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Time [milliseconds]&quot;</span>)</span></code></pre></div>
<div style="text-align:center">
<img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAC0FBMVEUAAAACAgIDAwMGBgYHBwcICAgJCQkLCwsMDAwNDQ0ODg4PDw8QEBARERESEhIUFBQVFRUWFhYXFxcZGRkaGhoeHh4gICAhISEiIiIkJCQlJSUmJiYnJycqKiorKystLS0uLi4vLy8xMTEzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///+Kgn/iAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2diV8U15r3mbkzc+dm7p3tzsydue877yzV3TQICiJxwcagoIAQ0QuuKOAS3IgQxWgUMAKakKBi4naN4i5ixA2NgCYuEBTjRtiackEEwtZd/8JbXV2nafpUVdfSgNX9fD+RpX6nn/Nw+pteq6u8KABQgNdINwCoGxAIUAQIBCgCBAIUAQIBigCBAEUMnUDtjnR1YJsk0tGltEJXr9IK7d1KC7zp63ThRN09sip0c2ZcG/naHXKBSEc62rBNEmnrUFqhA29LKj1KCzyn2l04UXefrAo9XNnzbo6NL3jaBYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZAYFkAgJZUZFAd7fMS97bRIJAXIBAzjBmeY9Z9L528jUQiAsQyAlNi7S5nRT1MMr3AgjEAQgkTMtCnzKmXGeCfxUIhAMCCbNWd4mt9ybc0AQCYYBAghQSh20FH/utBIEwQCAhLnln2lU8TJyXXMGxBxCIjTxCoLrguF67iua5IT9LLeHYAwjERp4gUEvcuJZBJZ/ot0gsgfUAArGRJwi0QVvhUHO7/o7EGo49gEBs5AEC7SOKHGt2jl8srQbWAwjERu4vUKk+zYwVPU58K6kI1gMIxEZuL9BFv3k9eFFT9HSjlCpYDyAQG7m7QMd9/9TJVbWK2C+hCt4DCMRG7i1Q/QZNchd32ZR3lTyVB4FQ5D4C/fhlYoieIEYZ4j/8oqS6hSSbb2QH6QtNPGWf6bP5l8UpIBCK3EWgqiStbs7mvUe+KdySEqYjCE1AgI4YlV7PXzfLt4Z/XZwBAqHIPQRq2qQLOfDadpHex5cPfVlwoOIXobrt45L418UZIBCK3EKgH6O8P+d4quWEYuIc/8I4AQRCkTsIVPXuhLsyCpviQpv4V0YYEAhFbiBQRWCEUVblOu/N/CsjDAiEIvUL9MPYGS9llt6hu8q/NIKAQChSvUAPJoW9kFu6Nyq0nn9thACBUKR2gRoigxvk137k+wH/2ggBAqFI5QK1LvG9p6R4MVHIvzgCgEAoUrlA2zQlyqpv1J3hXx1+QCAUqVug45o8hdX7En3L+JeHFxAIRaoW6KZfEt9bXaLpih91ln99+ACBUKRmgR5NDn+jvH7XQt0X/AvEAwiEIhUL1Dwn8JkrJuj7mFhUy79EnIBAKFKxQKt1jvvKy6U0yG+7tBeEQCAUqVegT4kjLpvj1cfeYz6+zb9MeA8gEBupVqAixU/ABtH4yWgitvAh/0o59AACsZFaBdqvXY9/1kIRnScXaLVzDzbwL5Z9DyAQG6lUoL3aNMVP4HGeH5hF+Kff4l+ugR5AIDZSp0BVmowh8MfCk21BmnnOX1oEgVCkToHKiLohm6/7aBgRd4F/yaw9gEBsBALhmM5NJ2YL3wqBQCgaGYEMAln5RfpLWbntd2zGIReIVqg0gog728q/biAQikZAoA0UtYdjc83i6AW3KKp/ZR89ondVP9qOzTgMAlkUiiKmFj7mWzcQCEUjIBDPzc/86+aK2RR1fh8z4uvzaDs247AIRFHm75K0+vm7bnJ+hh4EQtFwCNSePSsup5324nBsqpHaaEihDbFtu5Q8/xQz6lb/L5WLKSqrihlRmYMujc04TALRGIvitIRf5JK0zTQfrkyKj5oaEhI4KSQ0MmHFmi2f7z95seLew8c0j+5VXT59sGDLh8nxUe+FhMTyL7ioa0UcniNQdl5vb942Wpb9pt2ZzO2LYWBbMXV3GjvOEHqfohY3MiMaltAbzDExMfl9jpj6+yqHRyCa11cL0xIiQoOCQ6fGLFiWlrltO83H65YlTA8iMEZHxKekZW5fRPRgTeOYRYwRhuoXNUzcRGaBYUIRZ8a5kbtddOgCIYGi2yjqVQztRTPVEM0KZNvWNXCf1n14OUWF9zAbusPpDebU1NQD3Y709XbfGC6BzA//vCHB4GexwzcodGZCYqqF5PkzDf6sNPpAGh/2F7+QqIQlqTOJLqxpHJOIMYL0UL2ixombqF9gmFDElfVwbuRut4NdaWcCtUUzAjXPsBOozWqTVaCO7WaqjU4Tm5gNjYno0tht3vDdhd3ZPIHQhiVtyNtdVLQ7P2vD6uS58TMjI+Pjk9Kytu8+dqGyxvYo+1ltVdmxvbkbLUOiUvhv8u1u/MUMEsJz7sKy8vt687Itd2HmovX0t37aENs2ivl3nzLPKe8/spKitt5iRlRloUtjMw6TQD1HpxNB605z7+YBD6JRNCwPorPen8U8YN4ds6KFotbFWx5Eo20U828KRf20LHp5PUWVHGRGHLDtLI/NOCwCde19VzPvZAvfuoFAKBrOp/FCLx/a6F1peQXI8moQCzbjMAjUVTRO98FN/mUDgWzRWycQdfEK/eXKRdvv2IxDLlBnUbBupfBxgEEgFA2nQLdEXX1my0Hlewd29sFmHGKByPxAXaqzvRNBIBSp883Um96Lu4dkMtP1VG/fD+/xLxjqAQRiI3UKRJ7RL5B+RCmn1GRPICbveMS/XAM9gEBspFKByBJ9Up/zy0qh6fMwImBNmcBb8PY9gEBspFaByJO6D125U/TtFK3P0pOij1gGAqFItQKR+zQ7XTbHsyVEaOFT/mXCewCB2Ei9ApFZmjOumcFU5DPhoLQzH4BAKFKxQK1LfRQdGwjRkazJkHqgMhAIRSoWiGyInNCqvP6LKL9j/AvEAwiEIjULRP4YFKf4yfzL8KDv+NeHDxAIRaoWiLysT1dYvTMmUOg9Lz5AIBSpWyByL7FPUXHTMt9y/tXhBwRCkcoFIjO0V5UUL9QU8y+OACAQitQuUMtc/1r5tX/Qfsy/NkKAQChSu0Dks4hg2ccp6zRENfOvjRAgEIpULxBZN3nSzzJLb/T5gX9pBAGBUKR+gciaSRPk7R10S/MZ/8oIAwKhyA0EImun+l+QUbg3PFL2mZtBIBS5g0Dk00VEuvQzrhRpr/EvjBNAIBS5hUBka6Gff/ZDdAlT47WD2zIzc443Ctb1T+NfF2eAQChyD4FI8uEGf2Jiyubt2zemRPoShHb89MgJGs287/nrrgsQs+shDyAQitxFIJJsPPHRnNCQkKl/WpV37Afm2fmjfdM0mXz7TtdoC/iXxSkgEIrcRyAujAX6WJ4HRwmhMl8CsvYAArGRewtEklfGTnvOVfUCcUJCFbwHEIiN3F0g8lZQJMcZWXrfmy2lCN4DCMRGbi8QWeG3qB8r+pX2hqQiWA8gEBu5v0DkGW2WY80XAauk1cB6AIHYyAMEIncQjufFXO9fJ7GGYw8gEBt5gkCtS/weDSp5T7tTYgmsBxCIjTxBIPLZlKkddhX7osKVPIVnegCB2MgjBCJv+i2z+xhrgcJH0CQINBB5hkDkUU2+reAd700d0is49AACsZGHCETmEIfZesaJUa0gEAYIJEzrWu0Bptzz6cE1bSAQBgjkhNZ0YnUzZS6fFFRFgkA4IJBTvh6jDX+XiKkmQSAOQCDnPClK31RiOYAUCIQDAkkABMIBgSQAAuGAQBIAgXBAIAmAQDggkARAIBwQSAIgEA4IJAEQCAcEkgAIhAMCSQAEwgGBJAAC4YBAEgCBcEAgCYBAOCCQBEAgHBBIAmIEaq04eob/8B0gEIpAIG6+CSUIQrfyIU8MAqEIBOKiPplIvPby6Z7AoMvcA0AgFIFAHDyOGnWamdv4vh+3QSAQikAgnKeRgeg8Up1xgZxn4AWBUAQCYTTHj66xzf5ycgTXeTBBIBSBQBgf6m7YTV+jX88xBgRCEQjkyD7i4KD5d2nL8EEgEIpAIAeqfNYOnt8UG4rfiYFAKAKBBtMwdVqnQwMPdDl4DyAQG4FAg0nzeYB1kKXHnomBQCgCgQZxkusMiB3vJmI9gEBsBALZ8zBooZmjhRNEqWMPIBAbgUD2JAYauVowxU5rcegBBGIjEMiO/djROFnuaHY59AACsREINEC1/yq+JlYHPh7cAwjERiCQDWPcxNd8TbSMyhjcAwjERiCQjVzNDf4uvtRWDOoBBGIjEAhx1Rs7oL0dPe/Fttr3AAKxEQjE8njSzB6hNq4RX9v3AAKxEQhkxbhgTL1wH6sCHtj1AAKxEQhkZZP2kpM+XoxdZNcDCMRGIBDDF8Qup42cI4oGegCB2AgEsrBD84mITj70rbT1AAKxEQhEP35eQeRwvQXmSGeEAb2cCAKhyOMFaq7IDvQ7Lq6VpwFx7L5lIBCKPFegsg2xIQEBAVrCN6NZbC8V+iTru6ogEIo8VaCrUUTwipzt2788dMNxD0QhzmtTmFONgUAo8kyB3uTqpl82yemmxHtePQkCDUQeKdDLdCKnT2Y7V/ym14JAA5EnCtS6RntEfj81E8ZdBoFskScKtFFTrKQhY6x+PwiEIg8U6Etij7KOetKIzSZlPZAgEIJdVPUIdEq7SXFPe7TJPytqggSBEOySqkagSr/F/cqbujgqiu/YU2IBgaywK6oWgeomRrxxRVf3ggzVCtogQSAEu6AqEaghKrjRNW09M7x7U34fJAiEYNdTHQK1LPS946q+jOGB5bIbIUEgBLucqhDImKpzttuYBF7F+jl+YFUKIJAVdjXVIFDrWs0JV3bWMU9/WGYrJAiEYBdTBQK1pGoUvADNRc9KzfZW5xNzAwJZYddSBQKt0onc7Uc8pu3EkifyugGBWNilVIFAM9KGoLtz/hNL5LUDAllhF1INAmUMRXv1c4jFFc4nxwGBrLDrKE0gg0BWfpH+UlZu+x2b8e0SiDIdn0TM/qpOcjsgkBV2GSUItIGiuN7NvL04KrWBovpX9tEjelfZ3m/AZnzLBKIfS5+YoyHeW55bXPFUQjsgkBV2ESUIxH3z0zGjuvdAKkWd38eM+Po8CrAZ3zqBaIzH188cRRBEQFTKJ3tL7zgc1rX1QXlxQeaK+MiQCQE2AgOCQ6bPXrp+5zdXao1y/h61CPTs5tl9n2asSFp4jrMCu4JCArVnz4rLaae9OBybaqQ2GlJoQ2zbLiXPP2UZ9GQTRb2MpaisKmZEZY5l45EjRyrfONLdhW0SRdQQCmTB3Hzz+M602eNpjzTB0xOWrk1Pz0hPX7Zg5gRvepP3pNlLM7Zs37nHxmfbsz5aNifUx3JaoAkzF61av3VHwZf7JXDkoKhhh8WNEhgmFHFm9Ma9BQU5m9KSZ4f50X8fMSbs/QV+mVzXCjqijpBA2Xm9vXnbaFn2m3ZnMrcvhoFtxdTdaew4086dFLW4kRnRsMRyldBTr3HZFTxziAViMLXcOrQskHDAO3bbuTvN3fjwHmN1We6ffBzHuxeG1YfKaxteT+XcjQYd0UJIoOg2inoVQ3vRTDVEswLZtnXZ7tNqkgvoBz7hPcyG7nDLptevX3c9d6TzNbZJFEN5F0abU39p78bEMD29YGOjktbnfnX0/Pnr3104f2z/5x9/EBdi2U74BoeGRsTEhIWGhkbFRIWGjmf+79RNnLV84+cHTl/67l71oyfiefq6SdQ4UtSo1heyKpDPOTY+baW/VFdXXSs9smvb2vnTxlhF2sB5tYgUqC2aEah5hp1AbVabWIGOJj+xfEtsYjY0JqJLY3eab+FjoOavF40mCP1789J3FlfUc03eer/85Nc7tmxOs7E+7ePN+XtOXK5t4RovArU8BqL5+falU8UnuU8AyS6hkEBZ+X29edmWuzBz0Xr6Wz9tiG0bxfy7TzXGdfX307dAW28xI6psR3vCZnzrBKparPWenXOyWtpDYXgWZkWEQO1Z789iHjDvjlnRQlHr4i0PotE2q0BTqFIDzRSKKjnIjDhgO14qNuNbJtCzRcTUPY+dT+8ICGRFhEAIoZcPbfSutLwCZHk1iAWb8a0SyHzAd8I3sp6Fg0BW2IV0mUDUxSv0lysXbb9jM8oWKEHuhwn56VxBpHE+5nEOCGSFXUkxAt0SdZ2Ye+kvvQOHW8FmlCvQPl2K4FEQZdAcOeobec2AQAh2KVXwZip5Qr+k16Wt1U0YL+t9VAYQyAq7lmoQiDytXy7riAo83A6YWiu3FRAIwS6mKgQii7UbXNfYtVGxMp582QCBrLCrqQ6ByN1Eoav6OqdPUPTpVBDICrucKhGI3KwpdU1bh7VLuM4HLh4QyAq7nmoRyJjkW+2Cpsz5RJqsV38GAIGssCuqFoHIhsjxog+JyEvPWg1+Il6JgEBW2CVVjUDk/fEzlH46/vls/UlFPVgAgaywa6oegcgKv3nKXlCsmRj0HRxgio08UCCy1CdZyQuKZ30jquEIZSjyRIHIM96JUo7tOwjzZ5qkBjhGoi3ySIHavvULr5HXjSlDs7UVjtI6EHmmQB1VU7VrqmQ8Eupfpf2K6QEEYiMPFYhs+mw8oZ0YGhrxp4wzv4juxZymtb77DgKhyFMFIknj1cJPNqalJYcR4w6JOVePhU81+9keQCA28lyBbNxarlncLqqV00Qu6gEEYiMQiObk6BkvRHRSN2opOhoQCIQiEMhCZdCM104b+SU8zLb3KgiEIhCIoXLMPKc7TH+it53xEgSyRSCQlVLdZid93NLm2/UAArERCMRSQJwTbKNnaqTdR0hBIBSBQCytSaN/FmqjQHfDvgcQiI1AIMTjibMETqLR4Lt+UA8gEBuBQDbKtJ/xd7E0aNDRx0AgFIFAA2zR3eVr4gaxf3APIBAbgUADNE0P43lbrD8iavAe0CAQikAgO6r0POeiO6S57NADCMRGIJA9OzXXuVp4PXa5Yw8gEBuBQPYYZ49v42hh8yjHjzCDQCgCgQZRM2Y53kGd7lOsBxCIjUCgwfyZ+MaxAXN8CPYZVBAIRSCQAyt96xwaOEacwXsAgdgIBHLg57CwjsHzB6bgo0AgFIFAjtz0S7E/iJB5SSDHCb5BIBSBQBjFmmy76fcRxRxjQCAUgUA4O+wOIlShy+AaAgKhCATi4BMin/2cxt3Rcc1cI0AgFIFAXORoklvpqc3HR83kPgUYCIQiEIiT4sBR6w4VRBMpPAeBBoFQBAJx82hLqMZ/3lm+GARCEQgkCxAIRSCQLEAgFIFAsgCBUAQCyQIEQhEIJAsQCEUgkCxAIBSBQLIAgVAEAskCBEIRCCQLEAhFIJAsQCAUgUCyAIFQBALJAgRCEQgkCxAIRSCQLEAgFIFAsgCBUAQCyQIEQhEIJAsQCEWeJVDDA+ZDyiAQDgjkjNaL60IJQhtZ2AQCcQACCVO/K4wYn3n0/KEUraEcBMIBgQQwXkzz1yZfs35i+UGU/hQIhAEC4Rhrr5We+HPhpgUBRPCnAweB7l6mKxFZgRcQCEVuK9CPeXG+hAXNxPl5VfaHS6D6kn2viSkhAAiEIjcV6N4Knc/iXWV3nzS8NuElu6InPHJeQwgQCEVuKVBLrj74K6FzyDUGLmx1VkQQEAhF7ihQbYx2S4dw0W+JIidFhAGBUOSGApUFja9yWjXNr1q4ijAgEIrcT6D9+tnPnVd9PX6uYBUngEAocjeBWrOJNFHng79AHBQo4wwQCEVuJlDzSmKnyHN4Lxur4JkYCIQi9xKofq7umNi6Rv/V/OviDBAIRW4l0P0I/2viC+/TlPEvjBNAIBS5k0CV48fXSihsmjkVOwK9WEAgFLmRQGf9pjdJqlyj3ca/MsKAQChyH4EKtYveSCydpb/JvzSCgEAocheBjBlEpsA5c7npMsQYOWqJAARCkZsIVD9Pu09G7SpNLv/aCAECocg9BKqN8L8sq/hW/XX+xREABEKRWwh0c4Kkp1929ERO5j6SuBNAIBS5g0CXAsKlPf2y44n/IjkPg0AgFLmBQGd8417LL39Bs5F/eXgBgVCkfoGO6BO7lNTfQ+Txrw8fIBCKVC/QPu0Hvcom+JTI4V8gHkAgFKldoELNOo6dnqWxg1jOc04VXkAgFKlcoB3Ex4r9oagTvgaJH/QBgVCkboG2EJ+K3PtHmEdxRNwxKe+sgkAoUrNAxnXEFy6axHwuihi9ZEdJNef5CXFAIBSpWKDGJO1BF85TkxenJwjt+NjU3NM/8a8Y2wMIxEbqFaguxqfUxVP1Pb58ICd1ph9BhG+6yr9oJAg0EKlWoCvjx90eohlNT46vDiQMuff51w0EQpFKBTLu8I6R/faFGPrKV/nokkr43uYAgVCkUoHWaj4R9eEdJbz6KoyYlM29yxkIhKKREcggkJVfpL+Uldt+x2a0CDRnqVQd5GCuTPMjDOsOVjRiPYBAbDQCAm2gqD1c27tnW772r+yjR/Susu1eiM3ICLRCgRdS+OXbDANBEIFhsXOTV2/MP1BazdyrgUAoGgGBeG5+Ti2dYvl2fh8z4uvzaDs247AKZOFl5dHPN61OSogOGUW7pJ+WknvsvolvRZseV997zL/gdksvZpAQniNQe/asuJx22ovDsalGaqMhhTbEtu1S8vxTzKjqSkagrCpmRGUOujQ247ALZEfHT5eKMt73pzUKW5iRu6+4tPw6zbXSkwcLczKWxYe/62M5ptVY/gUXda2Iw3MEys7r7c3bRsuy37Q7k7l9MQxsK6buTmPHMQItbmRGNCyhfzbTV8YazpLzRkggK+bGq4UJ3gSGf2zaF0fOfbvReySbUxnouZCQQNFt9FOaGNqLZqohmhXItq1r4D6NESi8h9nQHW755ciRI5VvHOnuevMmfuQE6nlwLi/lPS1BaMaFz1m8bG16+pplSXOjQwOsEvmOCx2rx3rmoE/MICE6qF9EjRM3UV+/rAqcF+vgugBPu2hfQGcCtUUzAjXPsBOozWrTYIESm5gNjYno0tht3kjchbU/q664cGJf/rr5BlqdwNnrD5XcdXzz1fjw5oXiovwtmzMK+G/y7W78xQwSwnPuwrLy+3rzsi13Yeai9fS3ftoQ2zaK+XffMo4RaOstZkRVFro0NuPwCmR+sH9N5CjrrYsuOGLR+l2ldfAsbCAalgfRWe/PYh4w745Z0UJR6+ItD6LRNor5x7jDfCk5yIw4UIIujc04nALVbJ1I6CJX5R48W/5Drd1eZyAQiobzabzQy4c2eldaXgGyvBrEgs3ICGR4JEMHiXQcmkEEpp3+meOvBoFQ9NYJRF28Qn+5ctH2OzajRaArob6iDwQkkzsf+Wnn8+1lBgKhaDgFuiXqijNb9pHvHdjREJuReTe+/gMiU+HO9AKYqvPDiOAt/MfhBIFQpNI3U2kKdfOEDgUtE5Px9qncxDGE37JTLfzLBgLZIvUKRJ4bPd3oyolelGQvDLW8PBiUsLXUyQ7SIBCKVCwQWRk8+ZmrZuk9MUdLjJ/3UUHxdTHvZIFAKFKzQGS1IbjONZOUhBBxRTX864T1AAKxkaoFIuumBda4YIrXKcS8Cv5F4gAEQpG6BSIfRY7+XvEMT0JHf8O/RJyAQChSuUDk01i/GwoneBAUept/hbgBgVCkdoHIn+N9Liiq/2RcuNOPgeE9gEBspHqByKZErZIXpV8aQh/yrw8fIBCK1C8Q2bJSUyi7en9C4B3+5eEFBEKRGwhEtm6Sf4yO7dpS/tXhBwRCkTsIZDnIeHKnrOIVWukHl2J6AIHYyD0EIk/4Rst5W6N94vvyjjQOAqHITQQirwVP/FF67XV+d/nXRggQCEXuIhD5Y4TfRamlvyMK+ZdGEBAIRW4jEFm/ULtXWuUug8w7MBBoIHIfgUjjeolPxrbpb/GvjDAgEIrcSCDmyZiEQ0Y/0GXxL4wTQCAUuZVA9JOx2Bdi65pmhco+YSEIZIvcSyDyytgpYvcxO0zIegmR7QEEYiM3E4i8PXnsD6LKto75QKCMM0AgFLmbQORPMT6nxZRdFij9PXi7HkAgNnI7gcjGpURWn9Oq54iDglWcAAKhyP0EIlt36GKfOCs6dqFwESeAQChyQ4FI8tIknzzBU4iZFo6tc1ZEEBAIRW4pEFm/Se+f+R3/G/Sfa045rSEICIQi9xSIJGs3BROakFkLUtO2FF1+7lDyvHaLiBJCgEAocleBSNJYUZS5YmF81GQ9QUR92WxXsdwnRe57YLYeQCA2cl+BbLTe3r9Er02pQMdrOOy94KW0CjggEIo8QCALTwqnEFN3PTJT/RULiFVkh/QKDj2AQGzkIQLRt0MlSXrC1+BDhBaTbSAQBgjknPpTuZt3XKIf/oBAOCCQBEAgHBBIAiAQDggkARAIBwSSAAiEAwJJAATCAYEkAALhgEASAIFwQCAJgEA4IJAEQCAcEEgCIBAOCCQBEAgHBJIACIQDAkkABMIBgSQAAuGAQBIAgXBAIAmAQDggkARAIBwQSAIgEA4IJAEQCAcEkgAIhAMCSQAEwgGBJAAC4YBAEgCBcNxXoLeSK6tHugOK6ky97cJqB/JlXWy36BMltafeFYo9TKCv9SPdAUW1ESUurLZ2tqyLJS0WO/I58a1QDAINOyCQigGBWEAg4O0ABAIUAQIBigCBAEV4jkAbDQbDZ1RfYVxcofPjmQ8J3ZbHu2wDyvtgqkn+q24vjkptENWEdaTTCTxHoIUt/f0m6kR6Z2f6yRFp4NTSKfRXtgHFfVirSf2rOmZU9x5IFdMEO9LpBB4jUH/EioiPXlFJDynqYfKIdFBdabnK2QYU92GtJvWverKJol7GimmCHel0Ao8RiFx+v33bVir6F4r6ZeYI9WC5ytkGXNCHpZqMv8q0c6fIJiwjnU7gMQJZeBlDRdIr0RU5QvNbrnK2ARf0MYX9Lu2vqkku6BfXBDPS6QQeI1DDPYp6E0cteURRj5JGqAfLVc424II+LNUk/1VHk5+IbMI60ukEniPQjKf9u3dQxZv6+zYeH6EeLFc524AL+mAEkvhXNcZ19ff3i2mCHel0Ao8RiLo4Pyark+ovnJuwq3+EWmAe9lobcEEfzF2YxL+qlH5Sbpgipgl2pNMJPEcgYEgAgQBFgAgIzbgAAAKuSURBVECAIkAgQBEgEKAIEAhQBAhkxzQvK+sor1reQV5e/3fw77UD/4mn1ss0MKn0Tt8eVN28q/mpquqwV1VVVSOVauQd5FUx+MTS9FCrPQKXwan16mV/6qhQ9XWg6uaHgFqnC8JxQyP15oeZp0v8lG8zqm5+CGCvTYsS5yf99v9d+OLffruF/v1b3a+17GcpLKrYZ/Z3Ybcn/O43QdW24abMf//7sEaqJ+n3/5LcQ4+8Pu13fzhIUbv+853Ao15v0GgQyJ2wE+h/zv8w6a8MPy77izbq9m8Lvk/6yysoGpTZCdT3T0vLr8T+r2345n89fcFfT63444UL/5FKX0pXXD37Vx2Hf7Xl5vZ3vF6h0SCQO2En0HGKuur1lHpJ/xyzgd42bgqKBmV2/zV4fU9Rr46j4eZ/PEFR1ePaf0PfGJ39OzPltZOiSK9afRqdpnuRaDQI5E7YCfSj5Tcz8/N/XKe3Zf0XigZldv+ZE/763cxnFBre6vXScoFmrzZaFC/6sfb3zMXfuUZZ9GtBo0Egd8JOoFr2N/qHv2ae3b+DokHZoKfxzTnv/c1KNLzRq91ygWYv+mlbm1eT9YG2V+3fWwS67tWARoNA7gS3QH/4hv7++C6K+AR69UE/RR37WzTc/A5931Xzz3V/e46iSn5jRgL5We7CPvJ6ikaDQO4Et0Dpfzx298tfZ6CIT6D+f0i6eXWyn2342j+c/WHcf5uW/5+ysj9+QCGBjv5q6638f/F6hEaDQO4Et0C9Gf/+V3/cZEIR711Yuf7Xvwt7ahvet+Zf35n8mOpO+v3vmafxVoGo3f/5m9HVXg/QaBDIs5D6kqFTQCDPAgQahKqbHxEc30xVCryZ6mE8fPjUpfWaHj50ab1hBgQCFAECAYoAgQBFgECAIkAgQBEgEKCI/w/6HIX3ZawYYgAAAABJRU5ErkJggg==" />
</div>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>Let us complicate things a bit. Consider the previous example, but,
this time, there is space for one motorcycle to wait while the pump is
being used by another vehicle. In other words, cars see a queue size of
0 and motorcycles see a queue size of 1.</p>
<p>The new Markov chain is the following:</p>
<p><span class="math display">\[\vcenter{\xymatrix{
*=&lt;15mm,8mm&gt;[o][F]{car+} \ar@(r,u)[drr]^{\mu_\mathrm{c}} \\
*=&lt;15mm,8mm&gt;[o][F]{car} \ar@/_/[r]_{\mu_\mathrm{c}}
\ar@/^/[u]^{(1-p)\lambda} &amp;
*=&lt;15mm,8mm&gt;[o][F]{empty} \ar@/_/[l]_{p\lambda}
\ar@/^/[r]^{(1-p)\lambda} &amp;
*=&lt;15mm,8mm&gt;[o][F]{m/cycle} \ar@/^/[l]^{\mu_\mathrm{m}}
\ar@/_/[d]_{(1-p)\lambda} \\
&amp; &amp; *=&lt;15mm,8mm&gt;[o][F]{m/c+} \ar@/_/[u]_{\mu_\mathrm{m}}
}}\]</span></p>
<p><span class="math display">\[Q = \begin{pmatrix}
-\mu_\mathrm{c} &amp; 0 &amp; 0 &amp; \mu_\mathrm{c} &amp; 0 \\
(1-p)\lambda &amp; -(1-p)\lambda-\mu_\mathrm{c} &amp; \mu_\mathrm{c}
&amp; 0 &amp; 0 \\
0 &amp; p\lambda &amp; -\lambda &amp; (1-p)\lambda &amp; 0 \\
0 &amp; 0 &amp; \mu_\mathrm{m} &amp; -(1-p)\lambda-\mu_\mathrm{m} &amp;
(1-p)\lambda \\
0 &amp; 0 &amp; 0 &amp; \mu_\mathrm{m} &amp; -\mu_\mathrm{m} \\
\end{pmatrix}\]</span></p>
<p>where the states <em>car+</em> and <em>m/c+</em> represent <em>car +
waiting motorcycle</em> and <em>motorcycle + waiting motorcycle</em>
respectively.</p>
<p>With <span class="math inline">\(p\)</span> the steady state
distribution, the average number of vehicles in the system is given
by</p>
<p><span class="math display">\[N = 2(p_1 + p_5) + p_2 +
p_4\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Theoretical resolution</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,                   <span class="dv">0</span>,       <span class="dv">0</span>,               mu[<span class="dv">1</span>],            <span class="dv">0</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>              <span class="dv">1</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda<span class="sc">-</span>mu[<span class="dv">1</span>],   mu[<span class="dv">1</span>],                   <span class="dv">0</span>,            <span class="dv">0</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>              <span class="dv">1</span>,            p<span class="sc">*</span>lambda, <span class="sc">-</span>lambda,        (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda,            <span class="dv">0</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>              <span class="dv">1</span>,                   <span class="dv">0</span>,   mu[<span class="dv">2</span>], <span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda<span class="sc">-</span>mu[<span class="dv">2</span>], (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>              <span class="dv">1</span>,                   <span class="dv">0</span>,       <span class="dv">0</span>,               mu[<span class="dv">2</span>],       <span class="sc">-</span>mu[<span class="dv">2</span>]), </span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>            <span class="at">byrow=</span>T, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(A), B)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>N_average_theor <span class="ot">&lt;-</span> <span class="fu">sum</span>(P <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) ; N_average_theor</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; [1] 0.6349615</span></span></code></pre></div>
<p>As in the first example, we can simulate this chain by breaking down
the problem into two trajectories (one for each type of vehicle and
service rate) and two generators. But in order to disallow cars to stay
in the pump’s queue, we need to introduce a little trick in the cars’
<code>seize</code>: the argument <code>amount</code> is a function that
returns 1 if the pump is vacant and 2 otherwise. This implies that the
car gets rejected, because there is only one position in queue and that
<code>seize</code> is requesting two positions. Note also that the
environment <code>env</code> must be defined <strong>before</strong>
running, as it is needed inside the trajectory.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>option<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  car <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="cf">function</span>() {</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>      <span class="cf">if</span> (env <span class="sc">%&gt;%</span> <span class="fu">get_server_count</span>(<span class="st">&quot;pump&quot;</span>)) <span class="dv">2</span>  <span class="co"># rejection</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>      <span class="cf">else</span> <span class="dv">1</span>                                   <span class="co"># serve</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  mcycle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  </span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  env <span class="ot">&lt;-</span> <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;car&quot;</span>, car, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, p<span class="sc">*</span>lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;mcycle&quot;</span>, mcycle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda))</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>  env <span class="sc">%&gt;%</span> <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>}</span></code></pre></div>
<p>The same idea using a branch, with a single generator and a single
trajectory.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>option<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  vehicle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="fu">branch</span>(<span class="cf">function</span>() <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p)), <span class="fu">c</span>(F, F), </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;car&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>             <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="cf">function</span>() {</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>               <span class="cf">if</span> (env <span class="sc">%&gt;%</span> <span class="fu">get_server_count</span>(<span class="st">&quot;pump&quot;</span>)) <span class="dv">2</span>  <span class="co"># rejection</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>               <span class="cf">else</span> <span class="dv">1</span>                                   <span class="co"># serve</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>             }) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>             <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>),                 <span class="co"># always 1</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;mcycle&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>             <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>             <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>))</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  env <span class="ot">&lt;-</span> <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;vehicle&quot;</span>, vehicle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, lambda))</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  env <span class="sc">%&gt;%</span> <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>}</span></code></pre></div>
<p>We may also avoid messing up things with branches and
subtrajectories. We can decide the type of vehicle and set it as an
attribute of the arrival with <code>set_attribute()</code>. Then, those
attributes can be retrieved using <code>get_attribute()</code>. Although
the branch option is a little bit faster, this one is nicer, because
there are no subtrajectories involved.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>option<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  vehicle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>(<span class="st">&quot;car&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="fu">set_attribute</span>(<span class="st">&quot;vehicle&quot;</span>, <span class="cf">function</span>() <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p))) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="cf">function</span>() {</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">get_attribute</span>(env, <span class="st">&quot;vehicle&quot;</span>) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>          env <span class="sc">%&gt;%</span> <span class="fu">get_server_count</span>(<span class="st">&quot;pump&quot;</span>)) <span class="dv">2</span>    <span class="co"># car rejection</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      <span class="cf">else</span> <span class="dv">1</span>                                     <span class="co"># serve</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="fu">get_attribute</span>(env, <span class="st">&quot;vehicle&quot;</span>)])) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">1</span>)                    <span class="co"># always 1</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  env <span class="ot">&lt;-</span> <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">1</span>, <span class="at">queue_size=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;vehicle&quot;</span>, vehicle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, lambda))</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  env <span class="sc">%&gt;%</span> <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>}</span></code></pre></div>
<p>But if performance is a requirement, we can play cleverly with the
resource capacity and the queue size, and with the amounts requested in
each <code>seize</code>, in order to model the problem without checking
the status of the resource. Think about this:</p>
<ul>
<li>A resource with <code>capacity=3</code> and
<code>queue_size=2</code>.</li>
<li>A car always tries to seize <code>amount=3</code>.</li>
<li>A motorcycle always tries to seize <code>amount=2</code>.</li>
</ul>
<p>In these conditions, we have the following possibilities:</p>
<ul>
<li>Pump empty.</li>
<li>One car (3 units) in the server [and optionally one motorcycle (2
units) in the queue].</li>
<li>One motorcycle (2 units) in the server [and optionally one
motorcycle (2 units) in the queue].</li>
</ul>
<p>Just as expected! So, let’s try:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>option<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  vehicle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="fu">branch</span>(<span class="cf">function</span>() <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p)), <span class="fu">c</span>(F, F), </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;car&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>             <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>             <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">3</span>),</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>           <span class="fu">trajectory</span>(<span class="st">&quot;mcycle&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>             <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>             <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>             <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">2</span>))</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">3</span>, <span class="at">queue_size=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;vehicle&quot;</span>, vehicle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>}</span></code></pre></div>
<p>We are still wasting time in the <code>branch</code> decision. We can
mix this solution above with the <code>option.1</code> to gain extra
performance:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>option<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  car <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">3</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  mcycle <span class="ot">&lt;-</span> <span class="fu">trajectory</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="fu">seize</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="fu">timeout</span>(<span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="fu">release</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">amount=</span><span class="dv">2</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  </span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="fu">simmer</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>    <span class="fu">add_resource</span>(<span class="st">&quot;pump&quot;</span>, <span class="at">capacity=</span><span class="dv">3</span>, <span class="at">queue_size=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;car&quot;</span>, car, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, p<span class="sc">*</span>lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    <span class="fu">add_generator</span>(<span class="st">&quot;mcycle&quot;</span>, mcycle, <span class="cf">function</span>() <span class="fu">rexp</span>(<span class="dv">1</span>, (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">until=</span>t)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>}</span></code></pre></div>
<p>Options 1, 2 and 3 are slower, but they give us the correct numbers,
because the parameters (capacity, queue size, amounts) in the model
remain unchanged compared to the problem. For instance,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>gas.station <span class="ot">&lt;-</span> <span class="fu">option.1</span>(<span class="dv">5000</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Evolution + theoretical value</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">get_mon_resources</span>(gas.station), <span class="st">&quot;usage&quot;</span>, <span class="st">&quot;pump&quot;</span>, <span class="at">items=</span><span class="st">&quot;system&quot;</span>) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>N_average_theor)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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AiAvAEkJY3Kiom4b9N+dyPtb4/7kSVoAAiAvAMk7p9E4FZP3l4/J9k8md+rwPRAADeSnDJUWP2UAEH4LAyAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAqAnD0jhGX17HhYajVAaEUsLffLFVIJpT75YaN80zECYgbCEARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAARAAAdAvBpBUbOCP6cvpHeQbdQAEQN4BivjhDf6YN3HdvHmtWgACIG8ApX+9odsGaNYP72MJAyBvAclv733HBih+UcPkxkgAAiBvlzA7oLkL1+1duprugZ6fMGFCg8oziMqH8f8oJpZGiB8VG1yAaKjiF9FlbERDQ0NlsEcEksBggQgMEskKIUJpgQqRrGAilqYRylL5slioxofFNKF9j3xQAbq3iZC4RauwhGEJGxAgKWFMpEz/ARAADQBQxMTZaUvrptV9jE00AHkJKPMn+kVi+k8VRN521YDLeADCTxkABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAABEAA9CQBDfeIcBI+XCDCgkWyRpAwkbTwQJGs4SREJGukQqhYqNh7ihVTKHxYLEjT98gHMSClRwSTYKVAhASKZIWREJG0YIVIlpIECb2nWLFQsTSNWJbGh8UUoX2PHEsYljDsgQAIgAAIgAAIgAAIgAAIgAAIgAAIgAAIgAAIgAAIgADI3wDpKysACIAGDmjBzKnG+19oAQiABjgDPb1Sn5vyvwIkT6m3VH10qgKAhiygzZUVHx7ruq0jxvE59AY66ZUVPXtOkM09tw2+AHSo7OaxqoTdpdEANISXsGvWlnLD3XqLuWOxrnlm4o4dpq+O7TD3e9IFABkLur4/WkViZ14EoCEKSKaA2BK2ILW8Iv2j7IvNNU0r03JNp3VF2RcfH1D60RQ9BRSRWgVAQ3gGYoCWZDdWVt6vSWmuOU3k6qwY8uXMqY8PSC4opTOQ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" style="display: block; margin: auto;" /></p>
<p>However, it is not the case in options 4 and 5. The parameters of
these models are <em>adulterated</em> to fit our performance purposes.
Therefore, we need to extract the RAW data, rescale the numbers and plot
them. And, of course, we get the same figure:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>gas.station <span class="ot">&lt;-</span> <span class="fu">option.5</span>(<span class="dv">5000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">get_mon_resources</span>(gas.station) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">system =</span> <span class="fu">round</span>(system <span class="sc">*</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span> <span class="co"># rescaling</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">avg =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(<span class="fu">head</span>(system, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">diff</span>(time))) <span class="sc">/</span> time) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, avg)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Resource usage: pump&quot;</span>, <span class="at">x=</span><span class="st">&quot;time&quot;</span>, <span class="at">y=</span><span class="st">&quot;in use&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>N_average_theor)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Finally, these are some performance results:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">/</span>lambda</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>tm <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">option.1</span>(t), </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                     <span class="fu">option.2</span>(t), </span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                     <span class="fu">option.3</span>(t),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>                     <span class="fu">option.4</span>(t),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                     <span class="fu">option.5</span>(t))</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="fu">autoplot</span>(tm) <span class="sc">+</span> </span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">breaks=</span><span class="cf">function</span>(limits) <span class="fu">pretty</span>(limits, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Time [milliseconds]&quot;</span>)</span></code></pre></div>
<div style="text-align:center">
<img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAC0FBMVEUAAAACAgIDAwMGBgYHBwcICAgJCQkLCwsMDAwNDQ0ODg4PDw8QEBARERESEhIUFBQVFRUWFhYXFxcZGRkaGhoeHh4gICAhISEiIiIkJCQlJSUmJiYnJycqKiorKystLS0uLi4vLy8xMTEzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///+Kgn/iAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2diVsT6brgmTn3zrmn55w7y7l3zr1n5s6dmUoEFJC4taIBEVBAQLQRxFYEBQEVEQXFVkAR3LoROO3WbQsu2CK0oIh0I2K7oKAsigYQooDIGpJ8/8JUVZaqJJWiwic2Uu/v4UnI975fLW9+T21J6rNDAICB3W+9AMCnDQgEYAECAViAQAAWIBCABQgEYDFxAvVNIMMfoceIzV3eD9ncY3SAJzrAF+wffc/RyrXMgyr+JNOFGOxnZ44wWczK6WY94QIpJ443IzZ3sb2HatjWHm+HbO3Rjd7xRPv6eIK9qNuykbMwAxqzBrOktyYLMdDDejE8ymQxK6ebNQg0BiAQCMQCBGIAgUAgEAgLEAgEwgIEAoGwAIFAICxAIBAICxAIBMICBAKBsACBQCAsQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwAIFAIGs07lvi6r6zjj8JBAKBrPDdTKeE3ORZDoc6+bJAIBCIk84UIuYN2XUgTfpFE08eCAQCcdGxSZKv71wlc/vZeiIIBAJx0P7ltCvG3gpfx3yrmSAQCGTJy9WOZazug9uJ0F+tpIJAIJAFjX5OVaYTuL5AGnm1nSsXBAKBzLk5f+5D8ykMnvQgZoQdum1xRgYCgUCmvEydFtDOMQ3t4+Oh0wnZ1grTdBAIBGLzYL/M4bDK2nRGatIWEL6XusaqEz8gEMOUEuj+me2exIzkNt5JacpWEstvjlEnfkAghikjUPuF2LkEId9+dWDsqVX6SDY/460TPyAQwxQRqDZpJuG5r/yNwMmpz7q6fP2ap078gEAMU0GgziuhElnaU5sm+DZR4lVivU78gEAMv6FAcp5YZTn5UFYpRKD7GW7EssJhm2ZN8SCQCLttrU78gEAMv5VAyQjlcTTvlsvlR8ldTNwomaGKV48hUMvlZPKoeWutzfZQaK64E6svd4JAn6RAVjY/a1+r1RqESk/RGSdL+QRq3eYpIeZuuybgqNkKo5eWEbO3Xa3nLCoPIBDDRxOoL31FcEYf6cW5wNhOcksTRRpibLsRuaaISlL7xPjs7EEorYbOuJPBJ1A5sbmwZdzy6HmwdxFBuC7fmHz4dFHFvWcKzvoq21seVZdfLaAoLq9+pDR+JtLRUnfnZnFBwQXOT0kYQCBsgdKzVKqsA6QspzW5KfT2Rc60FaKHXrQn0Q19B/YjtL6NzlBEkG1ad3f3NDUHNcQzXH1oFNcOb/GSEnpmyua4mzBPJiMscZGRuDKvb3EtIYNWyx+3RGNzDzXS8E2PN4i4WrmWQGueaZ5kshBakxdMKmvl6FkPCRDIvxehngDSiw6k8NcLZGwbZO3TuskG7xG6YdibEigzM/PaIAdVH0agZ6e3+TlTDkhki5eHbYjenkSSlq6D+n9H9MawFd5urhLaFKnrQu/gsI3RcUlJW6I3ha1YusiVlE9yl2sJGTRq/rglQ6M290AjPNERvuAwGuJo5VrmUS1/kulCqIbZmRomi1k5etZCbvNLydLrTwvUsYwlUK/OJp1AikcIvQ9GaF073dC2ztCba7tbQcyNyq/TYNnzKktOTPOJO3T2+t2mLq6ZsOlsaWnp5Nhsk4GXY3SFXRj2Liwte1SVlU7twrT5u8gnNWmIsU0nUANSLHuhzj2M0P5aOqMmjU+grsupgQ6EbNuNkfHq0xAjdYor6uGaOC9wEM3w8Q6i04JW0AfMuQExrxFKDKEOog1tOoE8ECpfE5BGnlUVn6UzzhTzCUTR/lOqOzErQzEefRRxErecl3AdSPlpCGSA7/KhEVUcdQWIuhqkh2fllT8nOUs3Vmtt1Gcw23H2iXZrdeIHBGKYnAKh8gryoaLc+Jpn5Ule5rgTnt+8sMWf624Oqa3W68QPCMTw0QUSdtVYS32jR8VsVXhWnqarONKBcE+60CxsQ9Sylgi5x1cnfkAghqnwYaqOlwUJnhJiVnz56FgT69w9bUEBf534AYEYpo5AFC1XUj0Jtx94T+0fJzm6ZLKuOINAIJAJlRGSgGYrk3l/K20xMSejZcw68QMCMUw9gZTKcrnTNY5pNB8JlBKzN1/uMM0GgUAgc15GSHLMp3AvlHCKyLlrmQwCgUAWdKUS6SbnY+8TiSVn2jhzQSAQiIPDkhTWoXS93CnH2j1eQCAQiIsTkq3G8/kr073vW00EgUAgTs7ar+mh+458RWy08kUxChAIBOLmmuv8Yg3SVvnYH+X7pgYIBAJZoS6UmB00n/C9zZsFAoFAVrn5VVRKyRhfFAOBQCAsQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwAIFAICxAIBAICxAIBMICBAKBsACBQCAsQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwAIFAICxAIBAICxAIBMICBAKBsOAT6MWJzUlXLZtBIAYQiEegc65S30VEWIt5OwjEAAJZFahrDxHdgdBPMq9mswgIxAACWROoM16SS8+7cVaA2WBOIBADCGRFoM4Y6QX9zH912GIaA4EYQCBugdo3SIuMcz9HnDEJgkAMIBBnnZqDHUpYs493useOgkAMIBBXna5+LrvDnn3/Yi/2Pc5AIAYQyLJOFWuIkDbT+dc7bmYlgEAMIJBZnV6d8ifkRRZjtlwiDjE5IBADCGRSp5odzpLQEjXHEhyU5BuzQCAGEIipk+JMIDH7QCv3Emh3SnIMiSAQAwhkqNPtBBci5Efr469q9hC79TcrB4EYQCC6Tp0FfsS8A8/5FyJPqv9YDARiAIGoOt1YSqz6acyB6lDFzEU1VBcQiAEEejPSliTxqxa0GK3eTheUIBAbEOhNwxLHPK7zLi76oyT7O0EgFiDQpRlLngpfEM0RSVgTCMTwGwrENwB4ZTn5UFb5MQSK8hqwabFvyuYU2zwTEOhDC5RMntRwBl4sJR/UcaNkhireuGfhWXlcolbb5A9CHV8SQRf13xBqvVteUvnE2lBkDCDQhxbI2uZnMMqDfCw9RWecLJ2MApGbRj9iRkDk5nV+MoLG0S8hv7LVdLJt9bVVVVUPG3Vy6QRqu1uUs2dzRFjkt2MvFghkRl/6iuCMPtKLc4GxnWi3PIo0xNh2I3KN7ts32q8qKIHSauiMOxlUU0pKyoWhiSPadoEQqv9m88qA8IQjF6ufPHtUlhfvKSEImc8X66Mpwr9YtsCJMODq4R8atmZNWNASV/KVdEFgePh837EXa1ht64oMoxGeqErFExxBwxytGo62US1/0jBiz2eUvURqJpW1cvSs3wsQKD1Lpco6QMpyWpObQm9f5ExbIXroRWcVHUaUQOvb6AxFBCVQQEBA9ujEsXk8AvXf/Hp3yv780idvNWj4VWVOzFzKFdkiuYe3XO4mkxJs7GVu7u6znKl/JUs2JKVn+voJWC6NrSuiRmq+KG+Qs6uWo02DxkgymZKG/ULLSmVWjp71oACB/HsR6gkgvehACn+9QMa2Qf0+rSl6hBbIe4RuGPY29ObZ/OIyjl3Y8+2OhMsSXzcHgyLTA5O+vdHAOhR68fDW1YKT+WcLS6vrqW8SUbuw9vqbPxzaGuazcKF879iLBbswDoF6/WmBOpaxBOrV2aQT6KKcohmta6cb2tZNRoGGM6bNOaAbP7zhxg/5X58suj/mUTQcRGMLlJY9qspKp3Zh2vxd5JOaNMTYphOogU6ktkD7a+mMmrSPIVCAxZd/eGn2ccjmGYKVGxAI/yA6LWgFfcCcGxDzGqHEEOog2tCmE8jDKFDxWTrjTPFHEOiIJKLbBn9Kndyr4UIiw0c/jee7fGhEFUddAaKuBk28QG9KXT+v5FkWEzTZkvWt8FEGi8kpECqvIB8qyo2veVYelzcjj1cSW14LWqz3GyQZXfBhKpuPLlCtoHdKqyIfVMzBCc/K40LWqStP5rjnxdhL1ezpdJHqAgIxwIepdJ1a0lwloVeG+Beiwtmjlu4CAjGAQPo6KU4FEjNTn/Eswzlp2AtdFxCIAQRi6lS7W0asLBq2sggniQTD5R4QiAEEYtep/fsVhGxfC9cSXJTs6jKkgUAMIJBZne4mu0o2PLFYgLv2sUZ/QCAWIJBFndryF0pTB03n3zk3iHWPIBCIAQTiqFP7YQefl+zZq1fNfcaKg0AMIBBnnard5jxmzT5L+hM7CgIxgEDcN5hqXOZy3zj329IMkyAIxAACWbnF3YsAZ8NFc4UsxPT7GiAQAwhk7SabL4Nm3KTn/XaJW5NpCARiAIGs3ub3VZj06AhCzUtm15pFQCAGEMj6jcZffyWdvz3S3t3cHxCIBQjEN9RBTYLfysOWXz8EgRhAIBhsBQTCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwAIFAICxAIBAICxAIBMICBAKBsACBQCAsQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEelF89Q0ING7ELtC9TQ4EId3+yiIAAglD3AJ1HrSfn9fYmjc98KV5CAQShqgFUqyRHqDvy3ZvxvousxgIJAwxC9S+Sv/jSYRKiByzIAgkDDELFO3IDPWZPP2+aRAEEoaIBcolLjMl7ndbaboTA4GEIV6BHk7fwa5xBXHKJAwCCUO8Aq1e8N6kyLGu7LtogUACEa1AhcR10yK/kUWw4yCQMMQqULtbuHmVi4jvWAkgkDDEKlC2tNGizDEuD5kEEEgYIhWo2WWXZZnfLVraZswAgYQhUoGSnJUcdX7suNF4Lg8CCUOcAt2zP85Z6CuSfYYUEEgY4hQodIGVoYmOGT/SAIGEIUqBCogSa6VOkZ7V5YBAwhCjQM1z1lsttWar3iAQSBgiFKjrS1eeIT7VW6VHqSwQSBgiFChDUspXbM1+IqoJBBKK+AQ6Shweo9xFLjP33n492QXiG7+5spx8KGNG4+apDC5iE6gtgUjTWi28nq69zoRUNsfV1XX2knUZZcxQV5NGoGSE8jiaH6/3D6/VjRifjFTxahBIOMIEKlvocEbIGzR85+yRzOy8vOzkUGfCeVNBq677pBHIyuZnTZW2eiVCpafojJPGXbXAGo4HkQkU5dYk/F3SoXmQ5UVMC9iWnv1VYuzmyKTDRXXMdK0JVH8tJ2mt33xXKUFIXRd4B6+NjIkMCQkJKzZbOcEC9aWvCM7oI704FxjbiXbLo0hDjG03ItcU0Vm16qE75BlmWg2dcSeDajt//vyd9xNH/6jNXWzvoba5S7/K1h4DaIgnOqQPblptqz80z0/F+sySzfNaEb7Ky5EgXJbHpB7+5jTJudOmnD95/EByhK8zQUzzCE88kJN3/nxezoFdseEkMbGxLrvMVm4QDbx//06AQOlZKlXWAVKW05rcFHr7ImfaCtFDL32e3L0BofVtdIYigmzQEgSxdVwrDXAQOz6BEBppqq6++1TxruPpT4mkHmMxfePlxz1Mb807khGEvFM5p61/5hPIvxehngDSiw6k8NcLZGwbZPZpw+eiydmM0A3D3lQLOefBNxPH2xGbu9jeQ2Vzl+5hm3ugPp7o+/e656hxCfT0WLA9I4dTQMLxy7cePntOonxuQuu7trq75eePbFvhSiY6LlgasDI4YOlCxrhdZiv3DvWQjwIF6vWnBepYxhKoV2eTTqD+TC3qJaPr2umGtnWG3rYeD9iAyI6B4hyPq62+SZy8ubnfnZix7nhp7aM7ZSUlheWP2V++t34Q3XTzbM5XCZsjIzcnpB7K/a7gxyv5+flnnpmtnOBjoLTsUVVWOrUL0+bvIp/UpCHGNp1ADUi7qlJ9Pg6h/bV0Rk0aCCQcYQK9SJaG9I5tzcj1lFWe7u7LAxaTG485cZcMXxP67c7C+tKCVtAHzLkBMa8RSgyhDqINbTqBPBBq2uQf/RKh4rN0xpliEEg4Qi8klrgu7R5DH+2F+YQ8avfehISEpIM/3GNtcX7703i+y4dGVHHUZpa6GgQCCUbwleg7spUjPMUnjzojiIhfJutHGYIEQuUV5ENFufE1T2VwEZ9AyhsOnOdCBjq8XAqVk/azsNqxU0i0KvJBxVxx56kMLiIUSHmcqLRe+7aF8+9SSZNUoPHBUxlcxChQ50q3AWul7pS76S40g0DCEKNAyvsOB61U+p3PvEe6HBBIGKIUSLnPoZWz0COrXO/qU0AgYYhToJfzNnEWeptDmSEFBBKGOAVSniK4TmdOEqeNGSCQMEQqUKd3oOXXyh7YJzEZIJAwRCqQspj40bzKA+6+zHcPQSCBiFUg5ZoFg2ZVTnG8x4qDQMIQrUD3HTJNi3xXcowdB4GEIVqBlPvsG9g1HvH062SHQSBhiFegdk8f9g/kD0+rNgmDQMIQr0DKXxy2MmdiT+33mkZBIGGIWCDlGYnxJ2Ijvh5tpkEQSBhiFkh5jEjQ78V2Odw2i4FAwhC1QMrTDp5VZH01B4lc8xAIJAxxC6S8s5zwP/x1gCTLIgICCUPkAim7Ln0pcwz/yTIAAglD7AJRwJCXGIBAIBAWIBAIhAUIBAJhAQKBQFiAQCAQFiAQCIQFCAQCYQECgUBYiFug1x3UIwiEgagF+k7mdEIJAmEhZoF+lMYkSi6BQFiIWKAXc9dotOHz20EgHEQsUOr0NoSapDkgEA7iFajOIYuq7UZ5JwiEgXgFipf1UbWtIa6CQBiIVqBaqW60Eq1XBAiEgWgFipiv/z79t/bNIND4EatA5UShvrjdDkdAoPEjUoE6l/lpDNWNddeCQONGpALlSZgbTFUTP4NA40acAjW5bmGqq10SBQKNG3EKFDdTySrv99IHlj1AIGGIUqAyyVl2eYfmxlr2AIGEIUaBXnv5a0zqe0r6i0UPEEgYYhQoR/LAtL4jnv6vzXuAQMIQoUDNrgnmBa6V7jbvAQIJQ4QCJTp3WVQ4l9jXadoDBBKG+AT6RZrLUeJjkqBykx4gkDBEJ1Dnck/O8eZuLyF8voX7RNuM6AQ6LrnDXWRN+ZeShcXGHiCQMMQm0M8Ou63XueELifFQCAQShsgEerJg2RBPoTXHJBH63RgIJAxxCXTXbUEbf6lLHFe00KkgkDDEJFB7tuOSV2PV+q6rx69Uj0kvEN/4zZXl5EMZMzIsT2VwEY9Ar08ukO6xOlYqQ7OH09+6JrtAyQjlcTTfX+8Xq9CNGJ+MVPFqEEg4YwoUSkQ1Cnpz+rYQS8+0TG6BuDc//cvqVGdiESo9RWecLAWBhDOmQIt4Tr/MqA4hJAuW+y5duNDdNzg8ctuOvXuzj+R/f+Vmw9uW5tqrxxJCly70Cd2eX9350QTqS18RnNFHenEuMLYT7ZZHkYYY225Erimikp6nItQdiFBaDZ1xJ4NqVCgUb7snjh6VzV1s7zE6YmuPnmFbe/Si9zzR/v5ueZpggRB6VZCekpKy52BKUuzaVQGL3efI7Akj9l6RO1N2RXpKCaeQlLwrFb88eKynXvH0l59Lzx3dEe6zaFP34DvWEoyMcq1cHyJz3goQKD1Lpco6QMpyWpObQm9f5ExbIXropc/THDmC0Po2OkMRQTZoyQXeasOaA9bwsEUgDjTvXt0+k7ntwPeNo/qW/kIfwiqOCwVP2XBlnE8g/16EegJILzqQwl8vkLFt0LhPexx5nDzw8R6hG4a9qabq6uqm3onj3ajNXcbRQ2Vrj74Rm3ugfp7owECvTVugoerv8/LyTp3Pz8ncsz12fXhwgLdcJtGpIfXYsP9E3ol96+YSxIJ1e3K+v3i1TE95ddnFgm8zE8MWzyCCeoffs5ZApeZauX7U19vbI1CgXn9aoI5lLIF6dTbpBSqIfE49rWunG9rWGXrbejxgAyI6BhIuUOuOGQQhc3UiZXH9fLHvF6GRkdsS9h785mzZg6rbV3J2hCxyIpwWhqYWNny0Y6C07FFVVjq1C9Pm7yKf1KQhxjadQA2oLXhQrSa3QPtr6Ywa4xrbWkwbEI9AXo5p3YL0GT1sPzvj547JdRbWlxa0gj5gzg2IeY1QYgh1EG1o0wnkgUrkJB4IFZ+lM84Ug0DCGVOgln0zXL7V8LxHet6uku59NWmvA/FdPjSiiqOuAFFXg0AgwQi4Et24TRLaO1bxW+SzrlM9PmWBUHkF+VBRbnzNUxlcxCSQUlns6vuOv/QPZnk8olMnqUC1Y6eQaFXkg4oZ0JOnMriISyBl9cww3r3YFceAZl3mJBVofPBUBheRCaQslh6zXuc3CcRGhT4RBBKG2ARSpto/tVLlxj0znPO6DHkgkDBEJ1C7exDnTqxpHSH7qonpAQIJQ3QCKUuICxwlLnJ0O93O7gECCUN8Aik3zO2zqPCPkmiFaQ8QSBgiFKjO0eJDjabpG81+VwgCCUSEAinT7VtM66sJcn9l3gMEEoYYBVK4hZvWt4gosegBAglDjAIpC4lr7PKq3cMte4BAwhClQMqw+f2s8l4lfrbsAQIJQ5wCPXLcxypv4Gq4R+K4EadAyoPTnhmr+5j4CQQaNyIVqH1RqLG6O+eNgkDjRqQCKS8SZfriDjinw53qx49YBVIGL9H/brNA8gQEGj+iFajCMFhGYAiM1oOBaAVSrnOjf4/1hDgPAmEgXoFqpN9StU2c2w4CYSBegZTxsm6EOhwOwZipOIhYoKfO8QhtcX0BAuEgYoGUp4iM40Q+jBuPhZgFUmZKJdQd6kEgDEQtkLKxnnoEgTAQt0A6QCAMQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwEJNAN+ID1+e+tAyCQBiIR6DOnYT75i+kcy5bBEEgDMQj0HZpvgahl19KjpoHQSAMRCPQKeI7upaa/USOWRAEwkAsAjU5GQeM2C0tNg2CQBiIRaCoucYb/KrXyOpNgiAQBiIR6Bb7tmRv5wWb3A0IBMJAJAIF+bJvjFglyWYHQSAMxCFQEXHTpKD7HapYURAIA1EI1OUbZFrQkWXurAuKIBAGohDoMnHbrKLNMzYyYRAIAzEI1OW3wqKkRQRzPREEwkAMAhURlZY13S81fqYBAmEgAoEsjoBoNBHTb+kTQCAMRCDQBYsjIJqBQFmtLgEEwmDqC9S5ZDV3VbuXfF5HZ4BAGEx9gfIlD6yUtWOhvIHKAIEwmPICtcyKs1rX1s/dqU/FQCAMprxA25w6rBf2+Xy3WhAIi6kuULHkJF9lFZ7O50EgHKa4QE9mr+Yf6ftdFPHlg09SIL7xmyvLyYcy5uoXd8k+CFNboBaf+UqrVdZzZYF0/cU2i66TW6BkhPK42odXUo/UiPHJSBWvBoGEwylQ/MyGsd+MkfO+hFPEiRrTEcMmt0BWNj9FGz2op9JTdMbJUhBIOJwCrVsr7P14dixQSkz325xx+urth8302IWWhWl//PO9ujt1LYaXtYWZW2Ii49LP3zeqN3EC9aWvCM7oI704FxjbiXbLo0hDjG03ItcU0Vl1d2iB0mrojDsZIJBwsASi3qGqnPgAV0KHy+deodvS/vbjnYaXSuXr5nslf0sJdZMShuj8hV4L55AvnZeFhy8n+zh6hUVuS0hISD1UWFxZ12qY+8Db5l9vXMg5uJf6Fj+mQOlZKlXWAVKW05rcFHr7ImfaCtFDL30eLdD6NjpDEUH+r5XJZMnaCQR9jB62d7EdrnlsFC6QjsHWB5WlBWdOHNwZNJ0wwTvtu5u/PnlSc/PKdzmZqSl7D3//s/76QGdFbqKfjJ3rJKNxNLyWWq8B1TosQCD/XoR6AkgvOpDCXy+QsW2Q2afRAnmP0A3D3pRAmZmZ1wYnEPVH6KGxucvQqM090Ihl4wabBBp6ev1M1s7N4Sv93GdTmxvpPP+10duT4jesXEi+dFm+MSklZXt0mL+7zIVw/jww7ljJY4Xi2fXjMZ7TDKpI5viEbkpMTqfYv2vbhpVLnKlNFrkoag3Xyg2jocFBwxjAYwnU608L1LGMJVCvziZTgda10w1t6wy9bd2c2wDswnQ8Ox3nIaGc8Qr+cmNCcvrXP1TXsYYBb797/mDsF76LfX1DIuJT0rOzs7+KXe6i394EJX5dUFJSUVV1t1FteQzUVv+oWYm9C0vLHlVlpVO7MG3+LvJJTRpibNMJ1GAUaH8tnVFjHFzY1mLawBQXaKUgex7vcyOm+SXmX3/CnIkJOQtruHm9sKyui7XYE3cQnRa0gj5gzg2IeY1QYgh1EG1o0wnkYRSo+CydcaYYBBIOp0DHiJwx7dGWBxKzEorMb7owSU/j+S4fGlHFUVeAqKtBIJBguK9Ep0pu8hSa4lUYEXS9y7LnpywQKq8gHyrKja+5S/ZBmOICdYbJunhLfcNl/qVP6bOwWkECaVXkg0oLAtmAlQ9TG2dF8VX6O2l4C3yYisNUF0h5luDZiZ0kEjrh6xxYTHmBuoIXq6zV9TvJTuroBwTCYMoLpPxFetpKWa9It9NHzyAQBlNfIGXM3AHOqlbYR+su+4BAGIhAoIf2nBeDHs5Y06FLAIEwEIFAyq2yfsuaKub4v9LHQSAMxCBQHccmaMDHrdEQB4EwEINAyq2zLI6C4mZUG8MgEAaiEOiRxSboHHGWCYNAGIhCIOUWs6Og5unxrCgIhIE4BKpzOMaup8pPzv7wHQTCQBwCKXc5v2HVM2PaLXYQBMJAJAK1Ou9kylkpOWQSBIEwEIlAfTnSe4ZqvpKFmP4EDATCQCwC9fh66L+7/sbTrck0CAJhIBaB+n51Dqd/PvPcc/Y9syAIhIFoBFJec/CvHmg9PENu7g8IhIN4BFLe8iQIwmFnq0UQBMJARAIpO298e+k5RxAEwkBMAlkDBMIABAKBsACBQCAsQCAQCAsQCATCAgQCgbAAgUAgLEAgEAgLEAgEwgIEAoGwAIFAICxAIDEI9Klz9NTEz+NtbP14uzbGdgrMLNnJH++NfWwtdDabq7WJPWsQyBqrrQ/Z9cFoI26Nt2s18Vxg5rE5/PFOotxaKCGYe9YtzAsQyBogEAiEBQgEAgETDwgEYAECAViAQAAWIJA59PzKu3QAAARmSURBVACMoznBwTmjhqcPzv31frGK8c3k8Xr/8FqBXV8s5VuT3XK5/Ch3vHitX+qgRUhOYd4KApmhG4Dx0o6BgR2XDU8fmv5ldaozseObyZoqbfVKYV0Hozz41mTta7Vawxmviunp33PcIqRWqx+lm7eCQGboBmDc0IhQY6Th6UPzPBWh7sDxzaRWPXRnvaCu2q8qPHjWRO0T47OzhzO+pQ6h940cIW280rwVBLKAEsh/CKGh5YanCUBz5Mh4ZyJ3bxDUtegwtSpWM5XRDX0H9nPGV1wMW7pTyREqO20xQRDIAkogX7I8g76Gpw/P48jj6vHOZPhctJCuTdEj1KrwZnYHcMa9j77s+CbBMqReO2QxQRDIAkqgiGaEmjcYnj44BZHPxzmT/kwt6l0mpOtF+pi32Wqm4hG5nwrmnNLqfoQGfC1DD1MslxoEsoASqDBVPbr7ouHpQ9MWPEgekI5rJtpVlerzcUK7evCsiWLZC3XuYc54bk53b36yZeg4NZqgWSsIZAElkDondPUJteHpQ1NCbRs8xjeTpk3+0S+FdvXgW5PyNQFpA5zxoazAgLR3FiHtF9SXgMxaQSAACxAIwAIEArAAgQAsQCAACxAIwAIEYuFlpyMR2Vn/tYSd3f8yfV3P/Amn3k7DzNT2JZ08fNIL/6Fpqqk5Z1dTU9OGeH4zY1f9zuQ1maqzR/DvbCjq7Qyj6vZXf9LvwSe98BNA/ZgF4djQ2Lr5oeczKHyWk5lPeuEnAP27SSlR6vbH/3396//xx33k65+m/V5ajAwhkxh7F3Z//p/+MLvOmK5J+Zd/9GxDIxv+/E+RI2Rmldef/nIWoRP/9pmswO69IRsEmkqwBPq/pb+6/Z38yab/0Ivu//H4vQ3/scIQMomxBBr9bxsrKwL/nzF97z9fue7sgGL+ev36v8aSvaYV1q38Xf+53+27m/mZXY8hGwSaSrAEuojQLbsXqJv8PyCZbJvjYQiZxFh/Crt7CPVcNKRr/+slhOrm9P2B3Bhd/c9aZHcEIaVdvUMCGd1hpzRkg0BTCZZAT6hXWvr/f60i29L+3RAyibH+tKv/fl5KKzKkd9l1Ux067HpJUezIY+17dPfPbiNKv9eGbBBoKsESqF7/ivzn7+mz+88MIZOYyWl8R8bi/xRnSG+zo8fa6bAjT9t67dp1B9p29f9ICVRlpzBkg0BTCW6B/vID+dzy0BCyJlDPZjVCF/7BkK79jNx3Pf7vz/7hGkLFf9AaBHKidmE77V4YskGgqQS3QDv+euHhN79PMoSsCaT+Lxvu3lrkZEzf9perv875P5ro/1lW9tfNyCBQwe/212b/k12zIRsEmkpwC6RK+pe/+2uqxhCyugurdPj9nzxfGNNHt/7zZ4ta0PCGP/+ZPo3XCYRy/+0PLnV2Tw3ZIJC4sPWS4ZiAQOICBDLhk1743wTzD1NxgQ9TRUZj44sPOr32xsYPOr2PDAgEYAECAViAQAAWIBCABQgEYAECAVj8fzzaQRDsMeivAAAAAElFTkSuQmCC" />
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
